<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="DC.Type" content="reference">
      <meta name="DC.Title" content="CREATE_COLLECTION_FROM_QUERY_B Procedure">
      <meta name="DC.subject" content="APEX_COLLECTION, CREATE_COLLECTION_FROM_QUERY_B procedure">
      <meta name="keywords" content="APEX_COLLECTION, CREATE_COLLECTION_FROM_QUERY_B procedure">
      <meta name="DC.Relation" scheme="URI" content="APEX_COLLECTION.html#GUID-859B488C-2628-44D7-969F-50872C685B76">
      <meta name="DC.Creator" content="Harish Konakondla">
      <meta name="DC.Creator" content="Christina Cho">
      <meta name="DC.Creator" content="Hilary Farrell">
      <meta name="DC.Creator" content="Joel Kallman">
      <meta name="DC.Creator" content="Sharon Kennedy">
      <meta name="DC.Creator" content="Christian Neumueller">
      <meta name="DC.Creator" content="Anthony Raynor">
      <meta name="DC.Creator" content="Marc Sewtz">
      <meta name="DC.Creator" content="John Snyders">
      <meta name="DC.Creator" content="Jason Straub">
      <meta name="DC.Creator" content="Vladislav Unarov">
      <meta name="DC.Creator" content="Patrick Wolf">
      <meta name="DC.Creator" content="Terri Jennings">
      <meta name="DC.Publisher" content="May2020">
      <meta name="DC.Format" content="XHTML">
      <meta name="DC.Identifier" content="GUID-1C319954-50DF-4C28-8B57-2AA52066B900">
      <meta name="DC.Language" content="en-US">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>CREATE_COLLECTION_FROM_QUERY_B Procedure</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="API Reference">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="API Reference">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="oracle-application-express-api-reference.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2020-05-22T13:42:07-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2020">
      <meta name="dcterms.category" content="database">
      
      
      <meta name="dcterms.product" content="en/database/oracle/application-express/20.1">
      
      <link rel="prev" href="CREATE_COLLECTION_FROM_QUERY2-Procedure.html" title="Previous" type="text/html">
      <link rel="next" href="CREATE_COLLECTION_FROM_QUERY_B-Procedure-NBV.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"application-express","element_name":"Application Express","display_in_url":true},"release":{"short_name":"20.1","element_name":"Release 20.1","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Oracle Application Express API Reference">
    <meta name="dcterms.isVersionOf" content="AEAPI">
    <meta name="dcterms.identifier" content="F24719-02">
    <meta name="dcterms.release" content="Release 20.1">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="CREATE_COLLECTION_FROM_QUERY2-Procedure.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="CREATE_COLLECTION_FROM_QUERY_B-Procedure-NBV.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">API Reference</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="APEX_COLLECTION.html" property="item" typeof="WebPage"><span property="name"> APEX_COLLECTION </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">CREATE_COLLECTION_FROM_QUERY_B Procedure</li>
            </ol>
            <a id="GUID-1C319954-50DF-4C28-8B57-2AA52066B900" name="GUID-1C319954-50DF-4C28-8B57-2AA52066B900"></a><a id="AEAPI731"></a><a id="AEAPI732"></a><a id="AEAPI733"></a><a id="AEAPI734"></a><a id="AEAPI730"></a>
            
            <h2 id="AEAPI-GUID-1C319954-50DF-4C28-8B57-2AA52066B900" class="sect2"><span class="enumeration_section">8.32 </span>CREATE_COLLECTION_FROM_QUERY_B Procedure
            </h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p>Use this procedure to create a collection from a supplied query using bulk operations. This method offers significantly faster performance than the <code class="codeph">CREATE_COLLECTION_FROM_QUERY</code> method. The query is parsed as the application owner. If a collection exists with the same name for the current user in the same session for the current Application ID, an application error is raised.
                  </p>
                  <p>This procedure uses bulk dynamic SQL to perform the fetch and insert operations into the named collection. Two limitations are imposed by this procedure:</p>
                  <ol>
                     <li>
                        <p>The MD5 checksum for the member data is not computed. </p>
                     </li>
                     <li>
                        <p>No column value in query p_query can exceed 2,000 bytes. If a row is encountered that has a column value of more than 2,000 bytes, an error is raised during execution. In Oracle Database 11g Release 2 (11.2.0.1) or later, this column limit is 4,000 bytes.</p>
                     </li>
                  </ol>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-1C319954-50DF-4C28-8B57-2AA52066B900__GUID-A2D97457-2CA0-419A-B7B5-EF50E9E41B30">Syntax</p>
               </div>
               <!-- class="section" -->
               <div class="section"><pre class="pre codeblock"><code>APEX_COLLECTION.CREATE_COLLECTION_FROM_QUERY_B (
    p_collection_name    IN VARCHAR2,
    p_query              IN VARCHAR2,
    p_names  IN apex_application_global.vc_arr2,
    p_values IN apex_application_global.vc_arr2,
    p_max_row_count      IN NUMBER default null,
    p_truncate_if_exists IN VARCHAR2 default 'NO');</code></pre></div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1" id="GUID-1C319954-50DF-4C28-8B57-2AA52066B900__GUID-E513F2A5-5DB2-4829-84F7-2CE9DACEF770">Parameters</p>
               </div>
               <!-- class="section" -->
               <div class="tblformal" id="GUID-1C319954-50DF-4C28-8B57-2AA52066B900__CJAEHJFH">
                  <p class="titleintable">Table 8-11 CREATE_COLLECTION_FROM_QUERY_B Procedure Parameters</p>
                  <table cellpadding="4" cellspacing="0" class="Formal" title="CREATE_COLLECTION_FROM_QUERY_B Procedure Parameters" summary="Parameter descriptions for the CREATE_COLLECTION_FROM_QUERY_B procedure." width="100%" frame="hsides" border="1" rules="rows">
                     <thead>
                        <tr align="left" valign="top">
                           <th align="left" valign="bottom" width="31%" id="d30320e85">Parameter</th>
                           <th align="left" valign="bottom" width="69%" id="d30320e88">Description</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="31%" id="d30320e93" headers="d30320e85 ">
                              <p><code class="codeph">p_collection_name</code></p>
                           </td>
                           <td align="left" valign="top" width="69%" headers="d30320e93 d30320e88 ">
                              <p>The name of the collection. The maximum length is 255 characters. An error is returned if this collection exists with the specified name of the current user and in the same session.</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="31%" id="d30320e101" headers="d30320e85 ">
                              <p><code class="codeph">p_query</code></p>
                           </td>
                           <td align="left" valign="top" width="69%" headers="d30320e101 d30320e88 ">
                              <p>Query to execute to populate the members of the collection. If p_query is numeric, it is assumed to be a DBMS_SQL cursor.</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="31%" id="d30320e109" headers="d30320e85 ">
                              <p><code class="codeph">p_names</code></p>
                           </td>
                           <td align="left" valign="top" width="69%" headers="d30320e109 d30320e88 ">
                              <p>Array of bind variable names used in the query statement.</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="31%" id="d30320e117" headers="d30320e85 ">
                              <p><code class="codeph">p_values</code></p>
                           </td>
                           <td align="left" valign="top" width="69%" headers="d30320e117 d30320e88 ">
                              <p>Array of bind variable values used in the bind variables in the query statement.</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="31%" id="d30320e125" headers="d30320e85 ">
                              <p><code class="codeph">p_max_row_count</code></p>
                           </td>
                           <td align="left" valign="top" width="69%" headers="d30320e125 d30320e88 ">
                              <p>Maximum number of rows returned from the query in p_query which should be added to the collection.</p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="31%" id="d30320e133" headers="d30320e85 ">
                              <p><code class="codeph">p_truncate_if_exists</code></p>
                           </td>
                           <td align="left" valign="top" width="69%" headers="d30320e133 d30320e88 ">
                              <p>If <code class="codeph">YES</code>, then members of the collection will first be truncated if the collection exists and no error will be raised. If <code class="codeph">NO</code> (or not <code class="codeph">YES</code>), and the collection exists, an error will be raised.
                              </p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <!-- class="inftblhruleinformal" -->
               <div class="section">
                  <p class="subhead1" id="GUID-1C319954-50DF-4C28-8B57-2AA52066B900__GUID-7FB265D5-547A-42B8-97D4-6106737393B2">Example</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>The following example shows how to use the <code class="codeph">CREATE_COLLECTION_FROM_QUERY_B</code> procedure to create a collection named <code class="codeph">EMPLOYEES</code> and populate it with data from the <code class="codeph">emp</code> table.
                  </p><pre class="pre codeblock"><code>declare
 &nbsp;&nbsp;&nbsp;&nbsp;l_query varchar2(4000);
 Begin
 &nbsp;&nbsp;&nbsp;&nbsp;l_query := 'select empno, ename, job, sal from emp where deptno = :b1';
 &nbsp;&nbsp;&nbsp;&nbsp;APEX_COLLECTION.CREATE_COLLECTION_FROM_QUERY_B (
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_collection_name =&gt; 'EMPLOYEES',
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_query =&gt; l_query,
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_names =&gt; apex_util.string_to_table('b1'),
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_values =&gt; apex_util.string_to_table('10'));
 End;</code></pre><div class="infoboxnotealso" id="GUID-1C319954-50DF-4C28-8B57-2AA52066B900__GUID-4AE082A9-8214-4051-B018-1FF4DE14DF47">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="q">"<a href="GET_MEMBER_MD5-Function.html#GUID-A456F18D-10D5-48F6-B75F-FD9534FD91FD">GET_MEMBER_MD5 Function</a>"</span></p>
                        </li>
                        <li>
                           <p> <span class="q">"<a href="CREATE_COLLECTION-Procedure.html#GUID-99D165B6-26C8-4142-9013-9948AFD67FF2">CREATE_COLLECTION Procedure</a>"</span></p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="CREATE_OR_TRUNCATE_COLLECTION-Procedure.html#GUID-94CD827F-9C10-4362-B2A1-30145D451098">CREATE_OR_TRUNCATE_COLLECTION Procedure</a>"</span></p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="CREATE_COLLECTION_FROM_QUERY-Procedure.html#GUID-E2940996-DCB5-4056-B1C4-94C93BD6FB44">CREATE_COLLECTION_FROM_QUERY Procedure</a>"</span></p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="CREATE_COLLECTION_FROM_QUERY2-Procedure.html#GUID-7800CD9E-FD29-4E49-B637-A426D78A644C">CREATE_COLLECTION_FROM_QUERY2 Procedure</a>"</span></p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="CREATE_COLLECTION_FROM_QUERYB2-Procedure.html#GUID-A429035B-82A7-452F-94DE-AAD32B7C0821">CREATE_COLLECTION_FROM_QUERYB2 Procedure</a>"</span></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
            </div>
            <div>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="APEX_COLLECTION.html#GUID-859B488C-2628-44D7-969F-50872C685B76">APEX_COLLECTION</a></p>
                  </div>
               </div>
            </div>
            
         </div>
      </article>
   </body>
</html>